(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{wINB:function(e,t,n){"use strict";(function(e,i){n.d(t,"a",(function(){return Tt}));var o=n("xPkO"),r=n("jYEY"),s=n.n(r),a=n("cr+I"),u=n.n(a),c=n("rgKj"),p=n.n(c),l=n("kaUc");function h(e){return(h="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){y(e,t,n[t])}))}return e}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var _="$default_instance",I=2,b=4096,S=1e3,E="$identify",k="$groupidentify",O="api.amplitude.com",w="api.eu.amplitude.com",C="regionconfig.amplitude.com",N="regionconfig.eu.amplitude.com",A=0,D=1,P=2,x=3,q=4,T=5,R=6,U=7,j="amp_cookie_test",K="amp",M="",G="cookies",W="none",B="localStorage",L="sessionStorage",F="revenue_amount",J="$productId",$="$quantity",z="$price",V="$revenueType",Z="amp_device_id",H="referrer",X="utm_source",Q="utm_medium",Y="utm_campaign",ee="utm_term",te="utm_content",ne="[Amplitude] Attribution Captured",ie="http",oe="beacon",re=function(e){for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},se=function(e){for(var t="",n=0,i=0,o=0,r=0;n<e.length;)(i=e.charCodeAt(n))<128?(t+=String.fromCharCode(i),n++):i>191&&i<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&i)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),r=e.charCodeAt(n+2),t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&r),n+=3);return t},ae="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof self?self:"undefined"!==typeof e?e:void 0,ue={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){try{if(ae.btoa&&ae.atob)return ae.btoa(unescape(encodeURIComponent(e)))}catch(t){}return ue._encode(e)},_encode:function(e){var t,n,i,o,r,s,a,u="",c=0;for(e=re(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,r=(3&t)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(i=e.charCodeAt(c++))>>6,a=63&i,isNaN(n)?s=a=64:isNaN(i)&&(a=64),u=u+ue._keyStr.charAt(o)+ue._keyStr.charAt(r)+ue._keyStr.charAt(s)+ue._keyStr.charAt(a);return u},decode:function(e){try{if(ae.btoa&&ae.atob)return decodeURIComponent(escape(ae.atob(e)))}catch(t){}return ue._decode(e)},_decode:function(e){var t,n,i,o,r,s,a="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)t=ue._keyStr.indexOf(e.charAt(u++))<<2|(o=ue._keyStr.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(r=ue._keyStr.indexOf(e.charAt(u++)))>>2,i=(3&r)<<6|(s=ue._keyStr.indexOf(e.charAt(u++))),a+=String.fromCharCode(t),64!==r&&(a+=String.fromCharCode(n)),64!==s&&(a+=String.fromCharCode(i));return a=se(a)}},ce=Object.prototype.toString;function pe(e){switch(ce.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!==e?"nan":e&&1===e.nodeType?"element":"undefined"!==typeof i&&"function"===typeof i.isBuffer&&i.isBuffer(e)?"buffer":h(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e))}var le,he={DISABLE:0,ERROR:1,WARN:2,INFO:3},de=he.WARN,fe={error:function(e){de>=he.ERROR&&ve(e)},warn:function(e){de>=he.WARN&&ve(e)},info:function(e){de>=he.INFO&&ve(e)}},ve=function(e){try{console.log("[Amplitude] "+e)}catch(t){}},ye=function(e){return"string"===pe(e)&&e.length>b?e.substring(0,b):e},ge=function(e,t,n){return pe(e)===n||(fe.error("Invalid "+t+" input type. Expected "+n+" but received "+pe(e)),!1)},me=function(e){var t=pe(e);if("object"!==t)return fe.error("Error: invalid properties format. Expecting Javascript object, received "+t+", ignoring"),{};if(Object.keys(e).length>S)return fe.error("Error: too many properties (more than 1000), ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=i,r=pe(o);"string"!==r&&(o=String(o),fe.warn("WARNING: Non-string property key, received type "+r+', coercing to string "'+o+'"'));var s=Ie(o,e[i]);null!==s&&(n[o]=s)}return n},_e=["nan","function","arguments","regexp","element"],Ie=function e(t,n){var i=pe(n);if(-1!==_e.indexOf(i))fe.warn('WARNING: Property key "'+t+'" with invalid value type '+i+", ignoring"),n=null;else if("undefined"===i)n=null;else if("error"===i)n=String(n),fe.warn('WARNING: Property key "'+t+'" with value type error, coercing to '+n);else if("array"===i){for(var o=[],r=0;r<n.length;r++){var s=n[r],a=pe(s);"array"!==a?"object"===a?o.push(me(s)):o.push(e(t,s)):fe.warn("WARNING: Cannot have "+a+" nested in an array property value, skipping")}n=o}else"object"===i&&(n=me(n));return n},be=function(e,t){var n=pe(t);if("string"===n)return t;if("date"===n||"number"===n||"boolean"===n)return t=String(t),fe.warn("WARNING: Non-string groupName, received type "+n+', coercing to string "'+t+'"'),t;if("array"===n){for(var i=[],o=0;o<t.length;o++){var r=t[o],s=pe(r);"array"!==s&&"object"!==s?"string"===s?i.push(r):"date"!==s&&"number"!==s&&"boolean"!==s||(r=String(r),fe.warn("WARNING: Non-string groupName, received type "+s+', coercing to string "'+r+'"'),i.push(r)):fe.warn("WARNING: Skipping nested "+s+" in array groupName")}return i}fe.warn("WARNING: Non-string groupName, received type "+n+". Please use strings or array of strings for groupName")},Se=function(e){Object.prototype.hasOwnProperty.call(he,e)&&(de=he[e])},Ee=fe,ke=function(e){return!e||0===e.length},Oe=function(){return"undefined"!==typeof WorkerGlobalScope},we=function(e,t){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===n?void 0:decodeURIComponent(n[1].replace(/\+/g," "))},Ce=function e(t){if("array"===pe(t))for(var n=0;n<t.length;n++)t[n]=e(t[n]);else if("object"===pe(t))for(var i in t)i in t&&(t[i]=e(t[i]));else t=ye(t);return t},Ne=function(e){var t=pe(e);if("object"!==t)return fe.error("Error: invalid groups format. Expecting Javascript object, received "+t+", ignoring"),{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=i,r=pe(o);"string"!==r&&(o=String(o),fe.warn("WARNING: Non-string groupType, received type "+r+', coercing to string "'+o+'"'));var s=be(o,e[i]);null!==s&&(n[o]=s)}return n},Ae=ge,De=me,Pe=function(e){return!!ge(e,"deviceId","string")&&(!(e.indexOf(".")>=0)||(fe.error("Device IDs may not contain '.' characters. Value will be ignored: \"".concat(e,'"')),!1))},xe=function(e){return!!ge(e,"transport","string")&&(e!==ie&&e!==oe?(fe.error("transport value must be one of '".concat(oe,"' or '").concat(ie,"'")),!1):!(e!==ie&&!navigator.sendBeacon)||(fe.error("browser does not support sendBeacon, so transport must be HTTP"),!1))},qe=function(e){return!!(ge(e,"sessionId","number")&&new Date(e).getTime()>0)||(fe.error("sessionId value must in milliseconds since epoch (Unix Timestamp)"),!1)},Te=function(){return ae.location},Re=function(){for(var e="",t=0;t<22;++t)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(Math.floor(64*Math.random()));return e},Ue=function(e){try{for(var t=document.cookie.split(";"),n=null,i=0;i<t.length;i++){for(var o=t[i];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e)){n=o.substring(e.length,o.length);break}}return n}catch(r){return null}},je=function(e,t,n){var i=null!==t?n.expirationDays:-1;if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),i=o}var r=e+"="+t;i&&(r+="; expires="+i.toUTCString()),r+="; path=/",n.domain&&(r+="; domain="+n.domain),n.secure&&(r+="; Secure"),n.sameSite&&(r+="; SameSite="+n.sameSite),document.cookie=r},Ke=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.split(".")[q];return n&&(e=parseInt(n,32)),e||(Ee.warn("unable to parse malformed cookie: ".concat(t)),0)},Me=je,Ge=Ue,We=function(e){try{var t=document.cookie.split(";").map((function(e){return e.trimStart()})),n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){for(var u=s.value;" "===u.charAt(0);)u=u.substring(1);0===u.indexOf(e)&&n.push(u.substring(e.length))}}catch(c){o=!0,r=c}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}catch(p){return[]}},Be=function(e){return m(e).sort((function(e,t){var n=Ke(e);return Ke(t)-n}))},Le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=j+Re();if("undefined"===typeof document)return!1;var n=!1;try{var i=String(Date.now());je(t,i,e),Ee.info("Testing if cookies available"),n=Ue(t+"=")===i}catch(o){Ee.warn('Error thrown when checking for cookies. Reason: "'.concat(o,'"'))}finally{Ee.info("Cleaning up cookies availability test"),je(t,null,e)}return n},Fe=function(e){if(e){if("undefined"!==typeof document){var t=document.createElement("a");return t.href=e,t.hostname||ae.location.hostname}if("function"===typeof URL)return new URL(e).hostname||ae.location.hostname}return ae.location.hostname},Je=function(e){var t=Fe(e).split("."),n=[],i="_tldtest_"+Re();if(Oe())return"";for(var o=t.length-2;o>=0;--o)n.push(t.slice(o).join("."));for(var r=0;r<n.length;++r){var s=n[r],a={domain:"."+s};if(Me(i,1,a),Ge(i))return Me(i,null,a),s}return""},$e={expirationDays:void 0,domain:void 0},ze=function(e){var t="";return $e.domain&&(t="."===$e.domain.charAt(0)?$e.domain.substring(1):$e.domain),e+t},Ve=function(e){var t=ze(e)+"=",n=Ge(t);try{if(n)return JSON.parse(ue.decode(n))}catch(i){return null}return null},Ze=function(e,t){try{return Me(ze(e),ue.encode(JSON.stringify(t)),$e),!0}catch(n){return!1}},He=function(e){try{return Me(ze(e),null,$e),!0}catch(t){return!1}},Xe={reset:function(){$e={expirationDays:void 0,domain:void 0}},options:function(e){if(0===arguments.length)return $e;e=e||{},$e.expirationDays=e.expirationDays,$e.secure=e.secure,$e.sameSite=e.sameSite;var t=ke(e.domain)?"."+Je(Te().href):e.domain,n=Math.random();$e.domain=t,Ze("amplitude_test",n);var i=Ve("amplitude_test");return i&&i===n||(t=null),He("amplitude_test"),$e.domain=t,$e},get:Ve,set:Ze,remove:He,setRaw:function(e,t){try{return Me(ze(e),t,$e),!0}catch(n){return!1}},getRaw:function(e){var t=ze(e)+"=";return Ge(t)}},Qe=function(){function e(){d(this,e),this.map=new Map,this.length=0}return v(e,[{key:"key",value:function(e){var t=Array.from(this.map.keys())[e];return this.map.get(t)}},{key:"getItem",value:function(e){return this.map.get(e)}},{key:"setItem",value:function(e,t){this.map.has(e)||(this.length+=1),this.map.set(e,t)}},{key:"removeItem",value:function(e){this.map.has(e)&&(this.length-=1,this.map.delete(e))}},{key:"clear",value:function(){this.map.clear(),this.length=0}}]),e}();if(function(){var e,t=new Date;try{return ae.localStorage.setItem(t,t),e=ae.localStorage.getItem(t)===String(t),ae.localStorage.removeItem(t),e}catch(n){}return!1}())le=ae.localStorage;else if("undefined"!==typeof ae&&ae.globalStorage)try{le=ae.globalStorage[ae.location.hostname]}catch(Ut){}else if("undefined"!==typeof document){var Ye=document.createElement("div"),et="localStorage";Ye.style.display="none",document.getElementsByTagName("head")[0].appendChild(Ye),Ye.addBehavior&&(Ye.addBehavior("#default#userdata"),le={length:0,setItem:function(e,t){Ye.load(et),Ye.getAttribute(e)||this.length++,Ye.setAttribute(e,t),Ye.save(et)},getItem:function(e){return Ye.load(et),Ye.getAttribute(e)},removeItem:function(e){Ye.load(et),Ye.getAttribute(e)&&this.length--,Ye.removeAttribute(e),Ye.save(et)},clear:function(){Ye.load(et);for(var e,t=0;e=Ye.XMLDocument.documentElement.attributes[t++];)Ye.removeAttribute(e.name);Ye.save(et),this.length=0},key:function(e){return Ye.load(et),Ye.XMLDocument.documentElement.attributes[e]}},Ye.load(et),le.length=Ye.XMLDocument.documentElement.attributes.length)}else Oe()&&(le=new Qe);le||(le={length:0,setItem:function(e,t){},getItem:function(e){},removeItem:function(e){},clear:function(){},key:function(e){}});var tt,nt=le,it=function(){this.storage=null};it.prototype.getStorage=function(){if(null!==this.storage)return this.storage;if(Le())this.storage=Xe;else{var e="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(e){return 0===arguments.length?this._options:(e=e||{},this._options.expirationDays=e.expirationDays||this._options.expirationDays,this._options.domain=e.domain||this._options.domain||ae&&ae.location&&ae.location.hostname,this._options.secure=e.secure||!1)},get:function(t){try{return JSON.parse(nt.getItem(e+t))}catch(Ut){}return null},set:function(t,n){try{return nt.setItem(e+t,JSON.stringify(n)),!0}catch(Ut){}return!1},remove:function(t){try{nt.removeItem(e+t)}catch(Ut){return!1}}}}return this.storage};var ot=(y(tt={},G,!0),y(tt,W,!0),y(tt,B,!0),y(tt,L,!0),tt),rt=function(){function e(t){var n=t.storageKey,i=t.disableCookies,o=t.domain,r=t.secure,s=t.sameSite,a=t.expirationDays,u=t.storage;d(this,e),this.storageKey=n,this.domain=o,this.secure=r,this.sameSite=s,this.expirationDays=a,this.cookieDomain="";var c=Je(Te().href);if(this.cookieDomain=o||(c?"."+c:null),ot[u])this.storage=u;else{var p=i||!Le({domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays});this.storage=p?B:G}}return v(e,[{key:"getCookieStorageKey",value:function(){if(!this.domain)return this.storageKey;var e="."===this.domain.charAt(0)?this.domain.substring(1):this.domain;return"".concat(this.storageKey).concat(e?"_".concat(e):"")}},{key:"save",value:function(e){var t=e.deviceId,n=e.userId,i=e.optOut,o=e.sessionId,r=e.lastEventTime,s=e.eventId,a=e.identifyId,u=e.sequenceNumber;if(this.storage!==W){var c=[t,ue.encode(n||""),i?"1":"",o?o.toString(32):"0",r?r.toString(32):"0",s?s.toString(32):"0",a?a.toString(32):"0",u?u.toString(32):"0"].join(".");switch(this.storage){case L:ae.sessionStorage&&ae.sessionStorage.setItem(this.storageKey,c);break;case B:nt.setItem(this.storageKey,c);break;case G:this.saveCookie(c)}}}},{key:"saveCookie",value:function(e){Me(this.getCookieStorageKey(),e,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:this.expirationDays})}},{key:"load",value:function(){var e,t=this;if(this.storage===G){var n=this.getCookieStorageKey()+"=",i=We(n);if(0===i.length||1===i.length)e=i[0];else{var o=Be(i)[0];i.forEach((function(){return Me(t.getCookieStorageKey(),null,{})})),this.saveCookie(o),e=Ge(n)}}if(e||(e=nt.getItem(this.storageKey)),!e)try{e=ae.sessionStorage&&ae.sessionStorage.getItem(this.storageKey)}catch(Ut){Ee.info('window.sessionStorage unavailable. Reason: "'.concat(Ut,'"'))}if(!e)return null;var r=e.split("."),s=null;if(r[D])try{s=ue.decode(r[D])}catch(Ut){s=null}return{deviceId:r[A],userId:s,optOut:"1"===r[P],sessionId:parseInt(r[x],32),lastEventTime:parseInt(r[q],32),eventId:parseInt(r[T],32),identifyId:parseInt(r[R],32),sequenceNumber:parseInt(r[U],32)}}},{key:"clear",value:function(){var e;if(this.storage===G&&(e=Ge(this.getCookieStorageKey()+"="),Me(this.getCookieStorageKey(),null,{domain:this.cookieDomain,secure:this.secure,sameSite:this.sameSite,expirationDays:0})),e||(e=nt.getItem(this.storageKey),nt.clear()),!e)try{e=ae.sessionStorage&&ae.sessionStorage.getItem(this.storageKey),ae.sessionStorage.clear()}catch(Ut){Ee.info('window.sessionStorage unavailable. Reason: "'.concat(Ut,'"'))}return!!e}}]),e}(),st="$clearAll",at=function(){this.userPropertiesOperations={},this.properties=[]};at.prototype.add=function(e,t){return"number"===pe(t)||"string"===pe(t)?this._addOperation("$add",e,t):Ee.error("Unsupported type for value: "+pe(t)+", expecting number or string"),this},at.prototype.append=function(e,t){return this._addOperation("$append",e,t),this},at.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,st)||Ee.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"),this):(this.userPropertiesOperations.$clearAll="-",this)},at.prototype.prepend=function(e,t){return this._addOperation("$prepend",e,t),this},at.prototype.set=function(e,t){return this._addOperation("$set",e,t),this},at.prototype.setOnce=function(e,t){return this._addOperation("$setOnce",e,t),this},at.prototype.unset=function(e){return this._addOperation("$unset",e,"-"),this},at.prototype.preInsert=function(e,t){return this._addOperation("$preInsert",e,t),this},at.prototype.postInsert=function(e,t){return this._addOperation("$postInsert",e,t),this},at.prototype.remove=function(e,t){return this._addOperation("$remove",e,t),this},at.prototype._addOperation=function(e,t,n){Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,st)?Ee.error("This identify already contains a $clearAll operation, skipping operation "+e):-1===this.properties.indexOf(t)?(Object.prototype.hasOwnProperty.call(this.userPropertiesOperations,e)||(this.userPropertiesOperations[e]={}),this.userPropertiesOperations[e][t]=n,this.properties.push(t)):Ee.error('User property "'+t+'" already used in this identify, skipping operation '+e)};var ut=function(e,t,n){this.url=e,this.data=t||{},this.headers=n};ut.prototype.send=function(e){if(!!ae.XDomainRequest){var t=new ae.XDomainRequest;t.open("POST",this.url,!0),t.onload=function(){e(200,t.responseText)},t.onerror=function(){"Request Entity Too Large"===t.responseText?e(413,t.responseText):e(500,t.responseText)},t.ontimeout=function(){},t.onprogress=function(){},t.send(u.a.stringify(this.data))}else if("undefined"!==typeof XMLHttpRequest){var n=new XMLHttpRequest;n.open("POST",this.url,!0),n.onreadystatechange=function(){4===n.readyState&&e(n.status,n.responseText)},function(e,t){for(var n in t)("Cross-Origin-Resource-Policy"!==n||t[n])&&e.setRequestHeader(n,t[n])}(n,this.headers),n.send(u.a.stringify(this.data))}else{var i=void 0;fetch(this.url,{method:"POST",headers:this.headers,body:u.a.stringify(this.data)}).then((function(e){return i=e.status,e.text()})).then((function(t){e(i,t)}))}};var ct=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};ct.prototype.setProductId=function(e){return"string"!==pe(e)?Ee.error("Unsupported type for productId: "+pe(e)+", expecting string"):ke(e)?Ee.error("Invalid empty productId"):this._productId=e,this},ct.prototype.setQuantity=function(e){return"number"!==pe(e)?Ee.error("Unsupported type for quantity: "+pe(e)+", expecting number"):this._quantity=parseInt(e),this},ct.prototype.setPrice=function(e){return"number"!==pe(e)?Ee.error("Unsupported type for price: "+pe(e)+", expecting number"):this._price=e,this},ct.prototype.setRevenueType=function(e){return"string"!==pe(e)?Ee.error("Unsupported type for revenueType: "+pe(e)+", expecting string"):this._revenueType=e,this},ct.prototype.setEventProperties=function(e){return"object"!==pe(e)?Ee.error("Unsupported type for eventProperties: "+pe(e)+", expecting object"):this._properties=De(e),this},ct.prototype._isValidRevenue=function(){return"number"===pe(this._price)||(Ee.error("Invalid revenue, need to set price field"),!1)},ct.prototype._toJSONObject=function(){var e="object"===pe(this._properties)?this._properties:{};return null!==this._productId&&(e[J]=this._productId),null!==this._quantity&&(e[$]=this._quantity),null!==this._price&&(e[z]=this._price),null!==this._revenueType&&(e[V]=this._revenueType),e};var pt=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},lt="US",ht="EU",dt=function(e){var t=O;switch(e){case ht:t=w;break;case lt:t=O}return t},ft="8.18.4",vt={apiEndpoint:O,batchEvents:!1,cookieExpiration:365,cookieName:"amplitude_id",sameSiteCookie:"Lax",cookieForceUpgrade:!1,deferInitialization:!1,disableCookies:!1,deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:3e4,eventUploadThreshold:30,forceHttps:!0,includeFbclid:!1,includeGclid:!1,includeReferrer:!1,includeUtm:!1,language:function(){return"undefined"!==typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||""}(),library:{name:"amplitude-js",version:ft},logLevel:"WARN",logAttributionCapturedEvent:!1,optOut:!1,onError:function(){},onExitPage:function(){},onNewSessionStart:function(){},plan:{branch:"",source:"",version:"",versionId:""},platform:"Web",savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:18e5,storage:M,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},transport:ie,unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","Cross-Origin-Resource-Policy":"cross-origin"},serverZone:lt,useDynamicConfig:!1,serverZoneBasedApi:!1,sessionId:null},yt=new(function(){function e(){return d(this,e),e.instance||(this.ingestionEndpoint=O,e.instance=this),e.instance}return v(e,[{key:"refresh",value:function(e,t,n){var i="https";t||"https:"===ae.location.protocol||(i="http");var o=i+"://"+function(e){var t=C;switch(e){case ht:t=N;break;case lt:t=C}return t}(e),r=this;if(!!ae.XDomainRequest){var s=new ae.XDomainRequest;s.open("GET",o,!0),s.onload=function(){var e=JSON.parse(s.responseText);r.ingestionEndpoint=e.ingestionEndpoint,n&&n()},s.onerror=function(){},s.ontimeout=function(){},s.onprogress=function(){},s.send()}else{var a=new XMLHttpRequest;a.open("GET",o,!0),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var e=JSON.parse(a.responseText);r.ingestionEndpoint=e.ingestionEndpoint,n&&n()}},a.send()}}}]),e}()),gt=function(e){Object(o.a)()||Oe()||Ee.warn("amplitude-js will not work in a non-browser environment. If you are planning to add Amplitude to a node environment, please use @amplitude/node"),this._instanceName=ke(e)?_:e.toLowerCase(),this._unsentEvents=[],this._unsentIdentifys=[],this._ua=new p.a(navigator.userAgent).getResult(),this.options=g({},vt,{trackingOptions:g({},vt.trackingOptions)}),this.cookieStorage=(new it).getStorage(),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInitCallbacks=[],this._onNewSessionStartCallbacks=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._connector=null,this._userAgent=navigator&&navigator.userAgent||null};gt.prototype.Identify=at,gt.prototype.Revenue=ct,gt.prototype.init=function(e,t,n,i){var r=this;if("string"!==pe(e)||ke(e))Ee.error("Invalid apiKey. Please re-initialize with a valid apiKey");else try{this._connector=l.AnalyticsConnector.getInstance(this._instanceName),_t(this.options,n),(Object(o.a)()||Oe())&&void 0!==ae.Prototype&&Array.prototype.toJSON&&(Object(o.b)(),Ee.warn("Prototype.js injected Array.prototype.toJSON. Deleting Array.prototype.toJSON to prevent double-stringify")),this.options.cookieName!==vt.cookieName&&Ee.warn("The cookieName option is deprecated. We will be ignoring it for newer cookies"),this.options.serverZoneBasedApi&&(this.options.apiEndpoint=dt(this.options.serverZone)),this._refreshDynamicConfig(),this.options.apiKey=e,this._storageSuffix="_"+e+(this._instanceName===_?"":"_"+this._instanceName),this._storageSuffixV5=e.slice(0,6),this._oldCookiename=this.options.cookieName+this._storageSuffix,this._unsentKey=this.options.unsentKey+this._storageSuffix,this._unsentIdentifyKey=this.options.unsentIdentifyKey+this._storageSuffix,this._cookieName=K+"_"+this._storageSuffixV5,this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this._metadataStorage=new rt({storageKey:this._cookieName,disableCookies:this.options.disableCookies,expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie,storage:this.options.storage});var s=!!this.cookieStorage.get(this._oldCookiename),a=!!this._metadataStorage.load();this._useOldCookie=!a&&s&&!this.options.cookieForceUpgrade;var u=a||s;if(this.options.deferInitialization&&!u)return void this._deferInitialization(e,t,n,i);this.options.domain=this.cookieStorage.options().domain,"string"===pe(this.options.logLevel)&&Se(this.options.logLevel);var c=Nt(this);this._apiPropertiesTrackingOptions=Object.keys(c).length>0?{tracking_options:c}:{},this.options.cookieForceUpgrade&&s&&(a||bt(this),this.cookieStorage.remove(this._oldCookiename)),It(this),this._pendingReadStorage=!0;this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).map((function(e){return{event:e}})).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).map((function(e){return{event:e}})).concat(this._unsentIdentifys)),n&&n.onNewSessionStart&&this.onNewSessionStart(this.options.onNewSessionStart),function(e){n&&n.deviceId&&!Pe(n.deviceId)&&(Ee.error('Invalid device ID rejected. Randomly generated UUID will be used instead of "'.concat(n.deviceId,'"')),delete n.deviceId),r.options.deviceId=r._getInitialDeviceId(n&&n.deviceId,e),r.options.userId="string"===pe(t)&&!ke(t)&&t||"number"===pe(t)&&t.toString()||r.options.userId||null;var i=(new Date).getTime(),o=!r._sessionId||!r._lastEventTime||i-r._lastEventTime>r.options.sessionTimeout||r.options.sessionId;o&&(r.options.unsetParamsReferrerOnNewSession&&r._unsetUTMParams(),r._newSession=!0,r._sessionId=r.options.sessionId||i,r.options.sessionId=void 0,r.options.saveParamsReferrerOncePerSession&&r._trackParamsAndReferrer()),r.options.saveParamsReferrerOncePerSession||r._trackParamsAndReferrer(),r.options.saveEvents&&(mt(r._unsentEvents),mt(r._unsentIdentifys)),r._lastEventTime=i,Et(r),r._pendingReadStorage=!1,r._sendEventsIfReady();for(var s=0;s<r._onInitCallbacks.length;s++)r._onInitCallbacks[s](r);r._onInitCallbacks=[],r._isInitialized=!0,o&&r._runNewSessionStartCallbacks()}(),this.runQueuedFunctions(),"function"===pe(i)&&i(this);var p=this.options.onExitPage;if("function"===pe(p)&&!this.pageHandlersAdded){this.pageHandlersAdded=!0;ae.addEventListener("pagehide",(function(){!function(){var e=r.options.transport;r.setTransport(oe),p(),r.setTransport(e)}()}),!1)}this._connector.eventBridge.setEventReceiver((function(e){r._logEvent(e.eventType,e.eventProperties,e.userProperties)}));var h=this._connector.identityStore.editIdentity();this.options.deviceId&&h.setDeviceId(this.options.deviceId),this.options.userId&&h.setUserId(this.options.userId),h.commit()}catch(d){Ee.error(d),n&&"function"===pe(n.onError)&&n.onError(d)}},gt.prototype._runNewSessionStartCallbacks=function(){for(var e=0;e<this._onNewSessionStartCallbacks.length;e++)this._onNewSessionStartCallbacks[e](this)},gt.prototype.deleteLowerLevelDomainCookies=function(){var e=Fe(),t=this.options.domain&&"."===this.options.domain[0]?this.options.domain.slice(1):this.options.domain;if(t&&Oe()&&e!==t&&new RegExp(t+"$").test(e)){for(var n=e.split("."),i=t.split("."),o=n.length;o>i.length;--o){var r=n.slice(n.length-o).join(".");Me(this._cookieName,null,{domain:"."+r})}Me(this._cookieName,null,{})}},gt.prototype._getInitialDeviceId=function(e,t){if(e)return e;if(this.options.deviceIdFromUrlParam){var n=this._getDeviceIdFromUrlParam(this._getUrlParams());if(n)return n}return this.options.deviceId?this.options.deviceId:t||Re()};var mt=function(e){for(var t=0;t<e.length;t++){var n=e[t].event.user_properties,i=e[t].event.event_properties,o=e[t].event.groups;e[t].event.user_properties=De(n),e[t].event.event_properties=De(i),e[t].event.groups=Ne(o)}};gt.prototype._trackParamsAndReferrer=function(){var e,t,n,i;if(this.options.includeUtm&&(e=this._initUtmData()),this.options.includeReferrer&&(t=this._saveReferrer(this._getReferrer())),this.options.includeGclid&&(n=this._saveGclid(this._getUrlParams())),this.options.includeFbclid&&(i=this._saveFbclid(this._getUrlParams())),this.options.logAttributionCapturedEvent){var o=g({},e,t,n,i);Object.keys(o).length>0&&this.logEvent(ne,o)}};var _t=function e(t,n){if("object"===pe(n)){var i=new Set(["headers"]),o=function(i){if(Object.prototype.hasOwnProperty.call(t,i)){var o=n[i],r=pe(t[i]);("transport"!==i||xe(o))&&("sessionId"!==i||null===o?Ae(o,i+" option",r)&&("boolean"===r?t[i]=!!o:"string"===r&&!ke(o)||"number"===r&&o>0||"function"===r?t[i]=o:"object"===r&&e(t[i],o)):t[i]=qe(o)?o:null)}};for(var r in n)i.has(r)?t[r]=g({},t[r],n[r]):Object.prototype.hasOwnProperty.call(n,r)&&o(r)}};gt.prototype.runQueuedFunctions=function(){var e=this._q;this._q=[];for(var t=0;t<e.length;t++){var n=this[e[t][0]];"function"===pe(n)&&n.apply(this,e[t].slice(1))}},gt.prototype._apiKeySet=function(e){return!ke(this.options.apiKey)||(Ee.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+e),!1)},gt.prototype._loadSavedUnsentEvents=function(e){var t=this._getFromStorage(nt,e),n=this._parseSavedUnsentEventsString(t,e);return this._setInStorage(nt,e,JSON.stringify(n)),n},gt.prototype._parseSavedUnsentEventsString=function(e,t){if(ke(e))return[];if("string"===pe(e))try{var n=JSON.parse(e);if("array"===pe(n))return n}catch(Ut){}return Ee.error("Unable to load "+t+" events. Restart with a new empty queue."),[]},gt.prototype.isNewSession=function(){return this._newSession},gt.prototype.onInit=function(e){this._isInitialized?e(this):this._onInitCallbacks.push(e)},gt.prototype.onNewSessionStart=function(e){this._onNewSessionStartCallbacks.push(e)},gt.prototype.getSessionId=function(){return this._sessionId},gt.prototype.nextEventId=function(){return this._eventId++,this._eventId},gt.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},gt.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},gt.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},gt.prototype._sendEventsIfReady=function(){return 0!==this._unsentCount()&&(this.options.batchEvents?this._unsentCount()>=this.options.eventUploadThreshold||this.options.transport===oe?(this.sendEvents(),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout(function(){this._updateScheduled=!1,this.sendEvents()}.bind(this),this.options.eventUploadPeriodMillis)),!1):(this.sendEvents(),!0))},gt.prototype.clearStorage=function(){return this._metadataStorage.clear()},gt.prototype._getFromStorage=function(e,t){return e.getItem(t+this._storageSuffix)},gt.prototype._setInStorage=function(e,t,n){e.setItem(t+this._storageSuffix,n)};var It=function(e){if(e._useOldCookie){var t=e.cookieStorage.get(e._oldCookiename);"object"!==pe(t)||St(e,t)}else{var n=e._metadataStorage.load();"object"===pe(n)&&St(e,n)}},bt=function(e){var t=e.cookieStorage.get(e._oldCookiename);"object"===pe(t)&&(St(e,t),Et(e))},St=function(e,t){t.deviceId&&(e.options.deviceId=t.deviceId),t.userId&&(e.options.userId=t.userId),null!==t.optOut&&void 0!==t.optOut&&!1!==t.optOut&&(e.options.optOut=t.optOut),t.sessionId&&(e._sessionId=parseInt(t.sessionId,10)),t.lastEventTime&&(e._lastEventTime=parseInt(t.lastEventTime,10)),t.eventId&&(e._eventId=parseInt(t.eventId,10)),t.identifyId&&(e._identifyId=parseInt(t.identifyId,10)),t.sequenceNumber&&(e._sequenceNumber=parseInt(t.sequenceNumber,10))},Et=function(e){var t={deviceId:e.options.deviceId,userId:e.options.userId,optOut:e.options.optOut,sessionId:e._sessionId,lastEventTime:e._lastEventTime,eventId:e._eventId,identifyId:e._identifyId,sequenceNumber:e._sequenceNumber};e._useOldCookie?e.cookieStorage.set(e.options.cookieName+e._storageSuffix,t):e._metadataStorage.save(t)};gt.prototype._initUtmData=function(e,t){e=e||this._getUrlParams();var n=function(e,t){var n=e?"?"+e.split(".").slice(-1)[0].replace(/\|/g,"&"):"",i=function(e,t,n,i){return we(e,t)||we(n,i)},o=i(X,t,"utmcsr",n),r=i(Q,t,"utmcmd",n),s=i(Y,t,"utmccn",n),a=i(ee,t,"utmctr",n),u=i(te,t,"utmcct",n),c={},p=function(e,t){ke(t)||(c[e]=t)};return p(X,o),p(Q,r),p(Y,s),p(ee,a),p(te,u),c}(t=t||this.cookieStorage.get("__utmz"),e);return kt(this,n),n},gt.prototype._unsetUTMParams=function(){var e=new at;e.unset(H),e.unset(X),e.unset(Q),e.unset(Y),e.unset(ee),e.unset(te),this.identify(e)};var kt=function(e,t){if("object"===pe(t)&&0!==Object.keys(t).length){var n=new at;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n.setOnce("initial_"+i,t[i]),n.set(i,t[i]));e.identify(n)}};gt.prototype._getReferrer=function(){return"undefined"!==typeof document?document.referrer:""},gt.prototype._getUrlParams=function(){return ae.location.search},gt.prototype._saveGclid=function(e){var t=we("gclid",e);if(!ke(t)){var n={gclid:t};return kt(this,n),n}},gt.prototype._saveFbclid=function(e){var t=we("fbclid",e);if(!ke(t)){var n={fbclid:t};return kt(this,n),n}},gt.prototype._getDeviceIdFromUrlParam=function(e){return we(Z,e)},gt.prototype._getReferringDomain=function(e){if(ke(e))return null;var t=e.split("/");return t.length>=3?t[2]:null},gt.prototype._saveReferrer=function(e){if(!ke(e)){var t={referrer:e,referring_domain:this._getReferringDomain(e)};return kt(this,t),t}},gt.prototype.saveEvents=function(){try{var e=JSON.stringify(this._unsentEvents.map((function(e){return e.event})));this._setInStorage(nt,this.options.unsentKey,e)}catch(Ut){}try{var t=JSON.stringify(this._unsentIdentifys.map((function(e){return e.event})));this._setInStorage(nt,this.options.unsentIdentifyKey,t)}catch(Ut){}},gt.prototype.setDomain=function(e){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(Ae(e,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:e,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,It(this),Et(this)}catch(Ut){Ee.error(Ut)}},gt.prototype.setUserId=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ae(t,"startNewSession","boolean")){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=void 0!==e&&null!==e&&""+e||null,t&&(this.options.unsetParamsReferrerOnNewSession&&this._unsetUTMParams(),this._newSession=!0,this._sessionId=(new Date).getTime(),this._runNewSessionStartCallbacks(),this.options.saveParamsReferrerOncePerSession&&this._trackParamsAndReferrer()),Et(this),this._connector&&this._connector.identityStore.editIdentity().setUserId(this.options.userId).commit()}catch(Ut){Ee.error(Ut)}}},gt.prototype.setGroup=function(e,t){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setGroup()")&&Ae(e,"groupType","string")&&!ke(e)){var n={};n[e]=t;var i=(new at).set(e,t);this._logEvent(E,null,null,i.userPropertiesOperations,n,null,null,null)}},gt.prototype.setOptOut=function(e){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(Ae(e,"enable","boolean"))try{this.options.optOut=e,Et(this)}catch(Ut){Ee.error(Ut)}},gt.prototype.setSessionId=function(e){if(Ae(e,"sessionId","number"))try{this._sessionId=e,Et(this)}catch(Ut){Ee.error(Ut)}},gt.prototype.resetSessionId=function(){this.setSessionId((new Date).getTime())},gt.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(Re())},gt.prototype.setDeviceId=function(e){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(Pe(e))try{ke(e)||(this.options.deviceId=""+e,Et(this),this._connector&&this._connector.identityStore.editIdentity().setDeviceId(this.options.deviceId).commit())}catch(Ut){Ee.error(Ut)}},gt.prototype.setTransport=function(e){if(this._shouldDeferCall())return this._q.push(["setTransport"].concat(Array.prototype.slice.call(arguments,0)));xe(e)&&(this.options.transport=e)},gt.prototype.setUserProperties=function(e){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("setUserProperties()")&&Ae(e,"userProperties","object")){var t=Ce(De(e));if(0!==Object.keys(t).length){var n=new at;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.set(i,t[i]);this.identify(n)}}},gt.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var e=new at;e.clearAll(),this.identify(e)}};var Ot=function(e,t){for(var n=0;n<t._q.length;n++){var i=e[t._q[n][0]];"function"===pe(i)&&i.apply(e,t._q[n].slice(1))}return e};gt.prototype.identify=function(e,t,n,i){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("identify()"))if("object"===pe(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=Ot(new at,e)),e instanceof at){if(Object.keys(e.userPropertiesOperations).length>0)return this._logEvent(E,null,null,e.userPropertiesOperations,null,null,null,t,n,i);Dt(t,n,0,"No request sent",{reason:"No user property operations"})}else Ee.error("Invalid identify input type. Expected Identify object but saw "+pe(e)),Dt(t,n,0,"No request sent",{reason:"Invalid identify input type"});else Dt(t,n,0,"No request sent",{reason:"API key is not set"})},gt.prototype.groupIdentify=function(e,t,n,i,o,r){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("groupIdentify()"))if(Ae(e,"group_type","string")&&!ke(e))if(null!==t&&void 0!==t)if("object"===pe(n)&&Object.prototype.hasOwnProperty.call(n,"_q")&&(n=Ot(new at,n)),n instanceof at){if(Object.keys(n.userPropertiesOperations).length>0)return this._logEvent(k,null,null,null,y({},e,t),n.userPropertiesOperations,null,i,o,r);Dt(i,o,0,"No request sent",{reason:"No group property operations"})}else Ee.error("Invalid identify input type. Expected Identify object but saw "+pe(n)),Dt(i,o,0,"No request sent",{reason:"Invalid identify input type"});else Dt(i,o,0,"No request sent",{reason:"Invalid group name"});else Dt(i,o,0,"No request sent",{reason:"Invalid group type"});else Dt(i,o,0,"No request sent",{reason:"API key is not set"})},gt.prototype.setVersionName=function(e){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));Ae(e,"versionName","string")&&(this.options.versionName=e)},gt.prototype._logEvent=function(e,t,n,i,o,r,s,a,u,c){if(It(this),e)if(this.options.optOut)Dt(a,u,0,"No request sent",{reason:"optOut is set to true"});else try{var p;p=e===E||e===k?this.nextIdentifyId():this.nextEventId();var l=this.nextSequenceNumber(),h="number"===pe(s)?s:(new Date).getTime();c?this._sessionId=-1:(!this._sessionId||!this._lastEventTime||h-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=h,this._runNewSessionStartCallbacks()),this._lastEventTime=h,Et(this);var d=this._ua.browser.name,f=this._ua.browser.major,v=this._ua.device.model||this._ua.os.name,y=this._ua.device.vendor;i=i||{};var m=g({},this._apiPropertiesTrackingOptions);n=g({},n||{},m),t=t||{},o=o||{},r=r||{};var _={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:h,event_id:p,session_id:this._sessionId||-1,event_type:e,version_name:this.options.versionName||null,platform:Ct(this,"platform")?this.options.platform:null,os_name:Ct(this,"os_name")&&d||null,os_version:Ct(this,"os_version")&&f||null,device_model:Ct(this,"device_model")&&v||null,device_manufacturer:Ct(this,"device_manufacturer")&&y||null,language:Ct(this,"language")?this.options.language:null,api_properties:n,event_properties:Ce(De(t)),user_properties:Ce(De(i)),uuid:pt(),library:this.options.library,sequence_number:l,groups:Ce(Ne(o)),group_properties:Ce(De(r)),user_agent:this._userAgent};return wt(this)&&(_.plan={branch:this.options.plan.branch||void 0,source:this.options.plan.source||void 0,version:this.options.plan.version||void 0,versionId:this.options.plan.versionId||void 0}),e===E||e===k?(this._unsentIdentifys.push({event:_,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push({event:_,callback:a,errorCallback:u}),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),this._sendEventsIfReady(),e===E&&this._connector&&this._connector.identityStore.editIdentity().updateUserProperties(Ce(De(i))).commit(),p}catch(Ut){Ee.error(Ut)}else Dt(a,u,0,"No request sent",{reason:"Missing eventType"})};var wt=function(e){return e.options.plan&&(e.options.plan.source||e.options.plan.branch||e.options.plan.version||e.options.plan.versionId)},Ct=function(e,t){return!!e.options.trackingOptions[t]},Nt=function(e){for(var t=["city","country","dma","ip_address","region"],n={},i=0;i<t.length;i++){var o=t[i];Ct(e,o)||(n[o]=!1)}return n};gt.prototype._limitEventsQueued=function(e){e.length>this.options.savedMaxCount&&e.splice(0,e.length-this.options.savedMaxCount).forEach((function(e){Dt(e.callback,e.errorCallback,0,"No request sent",{reason:"Event dropped because options.savedMaxCount exceeded. User may be offline or have a content blocker"})}))},gt.prototype.logEvent=function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(e,t,null,n,i,o)},gt.prototype.logEventWithTimestamp=function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?Ae(e,"eventType","string")?ke(e)?(Dt(i,o,0,"No request sent",{reason:"Missing eventType"}),-1):(Ae(r,"outOfSession","boolean")||Dt(i,o,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,null,null,n,i,o,r)):(Dt(i,o,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(Dt(i,o,0,"No request sent",{reason:"API key not set"}),-1)},gt.prototype.logEventWithGroups=function(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?Ae(e,"eventType","string")?(Ae(r,"outOfSession","boolean")||Dt(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid outOfSession value"}),this._logEvent(e,t,null,null,n,null,null,i,o,r)):(Dt(event.callback,event.errorCallback,0,"No request sent",{reason:"Invalid type for eventType"}),-1):(Dt(event.callback,event.errorCallback,0,"No request sent",{reason:"API key not set"}),-1)};var At=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Dt=function(e,t,n,i,o){"function"===pe(e)&&e(n,i,o),"function"===pe(t)&&t(n,i,o)};gt.prototype.logRevenueV2=function(e){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()"))if("object"===pe(e)&&Object.prototype.hasOwnProperty.call(e,"_q")&&(e=Ot(new ct,e)),e instanceof ct){if(e&&e._isValidRevenue())return this.logEvent(F,e._toJSONObject())}else Ee.error("Invalid revenue input type. Expected Revenue object but saw "+pe(e))},gt.prototype.logRevenue=function(e,t,n){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logRevenue()")&&At(e)&&(void 0===t||At(t))?this._logEvent(F,{},{productId:n,special:"revenue_amount",quantity:t||1,price:e},null,null,null,null,null):-1},gt.prototype._logErrorsOnEvents=function(e,t,n,i){for(var o=["_unsentEvents","_unsentIdentifys"],r=0;r<o.length;r++)for(var s=o[r],a="_unsentEvents"===s?e:t,u=0;u<this[s].length;u++){var c=this[s][u];c.event.event_id<=a&&c.errorCallback&&c.errorCallback(n,i)}},gt.prototype.removeEvents=function(e,t,n,i){Pt(this,"_unsentEvents",e,n,i),Pt(this,"_unsentIdentifys",t,n,i)};var Pt=function(e,t,n,i,o){if(!(n<0)){for(var r=[],s=0;s<e[t].length;s++){var a=e[t][s];a.event.event_id>n?r.push(a):a.callback&&a.callback(i,o)}e[t]=r}};gt.prototype.sendEvents=function(){if(this._apiKeySet("sendEvents()")){if(this.options.optOut)this.removeEvents(1/0,1/0,0,"No request sent",{reason:"Opt out is set to true"});else if(0!==this._unsentCount()){if(this.options.transport!==oe){if(this._sending)return;this._sending=!0}var e=(this.options.forceHttps||"https:"===ae.location.protocol?"https":"http")+"://"+this.options.apiEndpoint,t=Math.min(this._unsentCount(),this.options.uploadBatchSize),n=this._mergeEventsAndIdentifys(t),i=n.maxEventId,o=n.maxIdentifyId,r=JSON.stringify(n.eventsToSend.map((function(e){return e.event}))),a=(new Date).getTime(),u={client:this.options.apiKey,e:r,v:I,upload_time:a,checksum:s()(I+this.options.apiKey+r+a)};if(this.options.transport!==oe){var c=this;try{new ut(e,u,this.options.headers).send((function(e,n){c._sending=!1;try{200===e&&"success"===n?(c.removeEvents(i,o,e,n),c.options.saveEvents&&c.saveEvents(),c._sendEventsIfReady()):(c._logErrorsOnEvents(i,o,e,n),413===e&&(1===c.options.uploadBatchSize&&c.removeEvents(i,o,e,n),c.options.uploadBatchSize=Math.ceil(t/2),c.sendEvents()))}catch(Ut){}}))}catch(Ut){var p="Request failed to send";Ee.error(p),c._logErrorsOnEvents(i,o,0,p),c.removeEvents(i,o,0,p,{reason:Ut.message})}}else{navigator.sendBeacon(e,new URLSearchParams(u))?(this.removeEvents(i,o,200,"success"),this.options.saveEvents&&this.saveEvents()):this._logErrorsOnEvents(i,o,0,"")}}}else this.removeEvents(1/0,1/0,0,"No request sent",{reason:"API key not set"})},gt.prototype._mergeEventsAndIdentifys=function(e){for(var t=[],n=0,i=-1,o=0,r=-1;t.length<e;){var s=void 0,a=o>=this._unsentIdentifys.length,u=n>=this._unsentEvents.length;if(u&&a){Ee.error("Merging Events and Identifys, less events and identifys than expected");break}a?i=(s=this._unsentEvents[n++]).event.event_id:u?r=(s=this._unsentIdentifys[o++]).event.event_id:!("sequence_number"in this._unsentEvents[n].event)||this._unsentEvents[n].event.sequence_number<this._unsentIdentifys[o].event.sequence_number?i=(s=this._unsentEvents[n++]).event.event_id:r=(s=this._unsentIdentifys[o++]).event.event_id,t.push(s)}return{eventsToSend:t,maxEventId:i,maxIdentifyId:r}},gt.prototype.setGlobalUserProperties=function(e){this.setUserProperties(e)},gt.prototype.__VERSION__=function(){return this.options.library.version},gt.prototype.setLibrary=function(e,t){null!==e&&"undefined"!==typeof e&&(this.options.library.name=e),null!==t&&"undefined"!==typeof t&&(this.options.library.version=t)},gt.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},gt.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},gt.prototype.enableTracking=function(){this._initializationDeferred=!1,Et(this),this.runQueuedFunctions()},gt.prototype._refreshDynamicConfig=function(){this.options.useDynamicConfig&&yt.refresh(this.options.serverZone,this.options.forceHttps,function(){this.options.apiEndpoint=yt.ingestionEndpoint}.bind(this))},gt.prototype.getDeviceId=function(){return this.options.deviceId},gt.prototype.getUserId=function(){return this.options.userId},gt.prototype.setMinTimeBetweenSessionsMillis=function(e){if(Ae(e,"timeInMillis","number")){if(this._shouldDeferCall())return this._q.push(["setMinTimeBetweenSessionsMillis"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.sessionTimeout=e}catch(Ut){Ee.error(Ut)}}},gt.prototype.setEventUploadThreshold=function(e){if(Ae(e,"eventUploadThreshold","number")){if(this._shouldDeferCall())return this._q.push(["setEventUploadThreshold"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.eventUploadThreshold=e}catch(Ut){Ee.error(Ut)}}},gt.prototype.setUseDynamicConfig=function(e){if(Ae(e,"useDynamicConfig","boolean")){if(this._shouldDeferCall())return this._q.push(["setUseDynamicConfig"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.useDynamicConfig=e,this._refreshDynamicConfig()}catch(Ut){Ee.error(Ut)}}},gt.prototype.setServerZone=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((e===ht||e===lt)&&Ae(t,"serverZoneBasedApi","boolean")){if(this._shouldDeferCall())return this._q.push(["setServerZone"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.serverZone=e,this.options.serverZoneBasedApi=t,t&&(this.options.apiEndpoint=dt(this.options.serverZone))}catch(Ut){Ee.error(Ut)}}},gt.prototype.setServerUrl=function(e){if(Ae(e,"serverUrl","string")){if(this._shouldDeferCall())return this._q.push(["setServerUrl"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.apiEndpoint=e}catch(Ut){Ee.error(Ut)}}};var xt=function(){this.options=g({},vt),this._q=[],this._instances={}};xt.prototype.Identify=at,xt.prototype.Revenue=ct,xt.prototype.getInstance=function(e){e=ke(e)?_:e.toLowerCase();var t=this._instances[e];return void 0===t&&(t=new gt(e),this._instances[e]=t),t},xt.prototype.init=function(e,t,n,i){this.getInstance().init(e,t,n,function(e){this.options=e.options,"function"===pe(i)&&i(e)}.bind(this))},xt.prototype.isNewSession=function(){return this.getInstance().isNewSession()},xt.prototype.getSessionId=function(){return this.getInstance().getSessionId()},xt.prototype.nextEventId=function(){return this.getInstance().nextEventId()},xt.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},xt.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},xt.prototype.saveEvents=function(){this.getInstance().saveEvents()},xt.prototype.setDomain=function(e){this.getInstance().setDomain(e)},xt.prototype.setUserId=function(e){this.getInstance().setUserId(e)},xt.prototype.setGroup=function(e,t){this.getInstance().setGroup(e,t)},xt.prototype.setOptOut=function(e){this.getInstance().setOptOut(e)},xt.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},xt.prototype.setDeviceId=function(e){this.getInstance().setDeviceId(e)},xt.prototype.setUserProperties=function(e){this.getInstance().setUserProperties(e)},xt.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},xt.prototype.identify=function(e,t){this.getInstance().identify(e,t)},xt.prototype.setVersionName=function(e){this.getInstance().setVersionName(e)},xt.prototype.logEvent=function(e,t,n){return this.getInstance().logEvent(e,t,n)},xt.prototype.logEventWithGroups=function(e,t,n,i){return this.getInstance().logEventWithGroups(e,t,n,i)},xt.prototype.logRevenueV2=function(e){return this.getInstance().logRevenueV2(e)},xt.prototype.logRevenue=function(e,t,n){return this.getInstance().logRevenue(e,t,n)},xt.prototype.removeEvents=function(e,t){this.getInstance().removeEvents(e,t)},xt.prototype.sendEvents=function(e){this.getInstance().sendEvents(e)},xt.prototype.setGlobalUserProperties=function(e){this.getInstance().setUserProperties(e)},xt.prototype.__VERSION__=ft;var qt="undefined"!==typeof ae&&ae.amplitude||{},Tt=new xt;for(var Rt in Tt._q=qt._q||[],qt._iq)Object.prototype.hasOwnProperty.call(qt._iq,Rt)&&(Tt.getInstance(Rt)._q=qt._iq[Rt]._q||[])}).call(this,n("ntbh"),n("HDXh").Buffer)}}]);